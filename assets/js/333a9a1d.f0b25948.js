"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[672],{8453:(e,n,t)=>{t.d(n,{RP:()=>c,xA:()=>i});var l=t(6540);const r=l.createContext({});function c(e){const n=l.useContext(r);return l.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const s={};function i({components:e,children:n,disableParentContext:t}){let i;return i=t?"function"==typeof e?e({}):e||s:c(e),l.createElement(r.Provider,{value:i},n)}},8844:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>l,toc:()=>o});const l=JSON.parse('{"id":"LuaScript/Reference by category/Time/snippet-scheduler","title":"Scheduler","description":"xLua doesn\'t have an update function by itself, but we can fake it. The following script can be added to LuaBehaviour or InteractTriggerX to call a function on an interval.","source":"@site/docs/LuaScript/4.Reference by category/2.Time/snippet-scheduler.md","sourceDirName":"LuaScript/4.Reference by category/2.Time","slug":"/LuaScript/Reference by category/Time/snippet-scheduler","permalink":"/community-docs/docs/LuaScript/Reference by category/Time/snippet-scheduler","draft":false,"unlisted":false,"editUrl":"https://github.com/BattleTalent/community-docs/docs/LuaScript/4.Reference by category/2.Time/snippet-scheduler.md","tags":[],"version":"current","frontMatter":{"title":"Scheduler"},"sidebar":"docs","previous":{"title":"UE - New Vector3","permalink":"/community-docs/docs/LuaScript/Reference by category/Basic/snippet-ue-vector-3"},"next":{"title":"UE - Time","permalink":"/community-docs/docs/LuaScript/Reference by category/Time/snippet-ue-time"}}');var r=t(4848),c=t(8453);const s={title:"Scheduler"},i=void 0,d={},o=[{value:"Example",id:"example",level:2},{value:"User Variables",id:"user-variables",level:2},{value:"FAQ",id:"faq",level:2},{value:"Can I stop the scheduler after a certain time?",id:"can-i-stop-the-scheduler-after-a-certain-time",level:3},{value:"Can I stop the scheduler from slowing down during slow motion?",id:"can-i-stop-the-scheduler-from-slowing-down-during-slow-motion",level:3},{value:"Tricks",id:"tricks",level:2},{value:"Call a function on the next frame",id:"call-a-function-on-the-next-frame",level:3},{value:"Lerp a value (you can even use this with Curve)",id:"lerp-a-value-you-can-even-use-this-with-curve",level:3},{value:"Stop inside scheduler function",id:"stop-inside-scheduler-function",level:3}];function a(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,c.RP)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["xLua doesn't have an update function by itself, but we can fake it. The following script can be added to ",(0,r.jsx)(n.code,{children:"LuaBehaviour"})," or ",(0,r.jsx)(n.code,{children:"InteractTriggerX"})," to call a function on an interval."]}),"\n",(0,r.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"First initialize some variables for the scheduler:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"self.schedulerId = nil\n\nself.schedulerInterval = 0.3   --Runs every 0.3 seconds.\nself.timeBeforeStarting = 0.2  --Starts after 0.2 seconds.\nself.timeBeforeStopping = -1   --Never stops and will run endlessly.\nself.ignoreSlowMotion = false  --Will not slow down when slow motion is activated.\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:"Then create functions to schedule:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'self.callOnSchedulerInterval = function(sche, t, s)\n    print("Im updating!") \nend\n\nself.callOnSchedulerStop = function(sche)\n    print("Im stopping now")\nend\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Create the scheduler itself somewhere:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"self.schedulerId = CL.Scheduler.Create({},\n    self.callOnSchedulerInterval,\n    self.schedulerInterval,\n    self.timeBeforeStopping,\n    self.timeBeforeStarting\n):SetUpdateChannel(CL.Scheduler.UpdateChannel.FixedUpdate)\n:IgnoreTimeScale(self.ignoreSlowMotion)\n:SetOnStop(self.callOnSchedulerStop).actionId\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"Important! Don't forget to remove the scheduler or it will continue to run and will drain performance."}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"CL.Scheduler.RemoveSchedule(self.schedulerId)\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"It is very important"})," though that you also call the ",(0,r.jsx)(n.code,{children:"RemoveSchedule"})," function in the ",(0,r.jsx)(n.code,{children:"OnDestroy"})," function so that it stops running when the weapon is destroyed."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"function table:OnDestroy()\n    if self.schedulerId ~= nil then\n        CL.Scheduler.RemoveSchedule(self.schedulerId)\n    end\nend\n"})}),"\n",(0,r.jsx)(n.h2,{id:"user-variables",children:"User Variables"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Component"}),(0,r.jsx)(n.th,{children:"variable"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"doesnt matter"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"self.schedulerId"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"int"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"self.schedulerInterval"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"int"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"self.timeBeforeStopping"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"int"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"self.timeBeforeStarting"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"bool"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"self.ignoreSlowMotion"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"func"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"self.callOnSchedulerInterval"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"func"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"self.callOnSchedulerStop"})})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"faq",children:"FAQ"}),"\n",(0,r.jsx)(n.h3,{id:"can-i-stop-the-scheduler-after-a-certain-time",children:"Can I stop the scheduler after a certain time?"}),"\n",(0,r.jsxs)(n.p,{children:["Change the ",(0,r.jsx)(n.code,{children:"self.timeBeforeStopping"})," to ",(0,r.jsx)(n.code,{children:"10"})," to stop it after 10 seconds."]}),"\n",(0,r.jsx)(n.h3,{id:"can-i-stop-the-scheduler-from-slowing-down-during-slow-motion",children:"Can I stop the scheduler from slowing down during slow motion?"}),"\n",(0,r.jsxs)(n.p,{children:["Change the ",(0,r.jsx)(n.code,{children:"self.ignoreSlowMotion"})," to ",(0,r.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"tricks",children:"Tricks"}),"\n",(0,r.jsx)(n.h3,{id:"call-a-function-on-the-next-frame",children:"Call a function on the next frame"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'local callOnSchedulerInterval = function(sche, t, s)\n    print("im executing next frame!") \nend\n\nCL.Scheduler.Create({}, callOnSchedulerInterval)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"lerp-a-value-you-can-even-use-this-with-curve",children:"Lerp a value (you can even use this with Curve)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"local callOnSchedulerInterval = function(sche, t, s)\n\tlocal progress = t/s\n    local lerpedVec = UE.Vector3.Lerp(fromVector, toVector, progress)\n    print(lerpedVec)\nend\n\nCL.Scheduler.Create({}, callOnSchedulerInterval, 0, 1)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"stop-inside-scheduler-function",children:"Stop inside scheduler function"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"local callOnSchedulerInterval = function(sche, t, s)\n    sche:Stop()\nend\n\nCL.Scheduler.Create({}, callOnSchedulerInterval, 0, 1)\n"})})]})}function h(e={}){const{wrapper:n}={...(0,c.RP)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);