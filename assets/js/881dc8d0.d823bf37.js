"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7373],{4176:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>a,default:()=>p,frontMatter:()=>c,metadata:()=>r,toc:()=>i});const r=JSON.parse('{"id":"complete-scripts/script-retractable","title":"RetractableScript","description":"Makes an object retractable with sounds.","source":"@site/docs/complete-scripts/script-retractable.md","sourceDirName":"complete-scripts","slug":"/complete-scripts/script-retractable","permalink":"/community-docs/docs/complete-scripts/script-retractable","draft":false,"unlisted":false,"editUrl":"https://github.com/BattleTalent/community-docs/docs/complete-scripts/script-retractable.md","tags":[],"version":"current","frontMatter":{"title":"RetractableScript"},"sidebar":"docs","previous":{"title":"ParticlesOnTriggerScript","permalink":"/community-docs/docs/complete-scripts/script-particles-on-trigger"},"next":{"title":"RoundSlicingScript","permalink":"/community-docs/docs/complete-scripts/script-round-slicing"}}');var l=n(4848),s=n(8453);const c={title:"RetractableScript"},a=void 0,o={},i=[{value:"Code",id:"code",level:2},{value:"Component",id:"component",level:2}];function d(e){const t={code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,s.RP)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(t.p,{children:"Makes an object retractable with sounds."}),"\n",(0,l.jsx)(t.h2,{id:"code",children:"Code"}),"\n",(0,l.jsx)(t.pre,{children:(0,l.jsx)(t.code,{className:"language-lua",children:"local table = {}\r\n\r\nfunction table:Awake()\r\n    --system will cache up cols, we should do this manual before disabling collider\r\n    self.host.interact:GetCols() \r\n    self.initLocalScale = self.blade.localScale\r\n    self.blade.localScale = UE.Vector3.zero\r\n    self.blade.gameObject:SetActive(false)\r\n    self.host.interact:SetAsNoTrail()\r\n    self.scaleActId = -1\r\n    self.lightUp = false\r\n    self.soundPlayTime = 0\r\n    self.delayScaleAct = -1\r\n    self.isOpen = false\r\nend\r\n\r\nfunction table:UpdateSkill()\r\n\tlocal shootInterval = self.shootInterval or 0.1\r\n\tlocal st = self.shootTime or 0\r\n\tlocal ct = UE.Time.time\r\n\tif ct - st < shootInterval then\r\n\t\treturn\r\n\tend\t\r\n\r\n    self:ToggleRetractable()\r\nend\r\n\r\nfunction table:ToggleRetractable()\r\n    if (self.isOpen) then\r\n        if (lightUp == false) then\r\n            return\r\n        end\r\n\r\n        self.isOpen = self.isOpen == false;\r\n        self.host.interact.rb.centerOfMass = UE.Vector3(0, 0, 0)\r\n        self.host.interact.rb.mass = 6\r\n        self.saberEndSound:PlaySound()\r\n        self.soundPlayTime = UE.Time.time\r\n        self:DoScale(false)            \r\n        return\r\n    end\r\n    \r\n    self.isOpen = self.isOpen == false;\r\n    self.saberBeginSound:PlaySound()\r\n    self:DoScale(true)\r\n    self.host.interact.rb.centerOfMass = UE.Vector3(0, 0, 0.5)\r\n    self.host.interact.rb.mass = 12\r\nend\r\n\r\nfunction table:DoScale(scaleUp)\r\n    self.lightUp = scaleUp\r\n    local so = self.host.interact:GetStabObject()\r\n    local blade = self.blade\r\n    local startScale = blade.localScale\r\n    \r\n    --local endScale = scaleUp ? initLocalScale : Vector3.zero;\r\n    local endScale = UE.Vector3.zero\r\n    if (scaleUp) then\r\n        endScale = self.initLocalScale\r\n    end\r\n        \r\n    if (scaleUp) then\r\n        blade.gameObject:SetActive(true)\r\n        so.scalingForward = true\r\n    else     \r\n        so:BreakAllStab()\r\n    end\r\n    \r\n    CL.Scheduler.RemoveSchedule(self.scaleActId)\r\n    self.scaleActId = CL.Scheduler.Create(self.host, \r\n        function (sche, t, s)\r\n            self.blade.localScale = UE.Vector3.Lerp(startScale, endScale, CL.EasingEquations.QuadEaseInOut(t, 0, 1, s))\r\n            self.rigidBody.centerOfMass = UE.Vector3(0,0,0);\r\n            if (t>=s) then\r\n                so.scalingForward = false\r\n                if (scaleUp == false) then\r\n                    self.blade.gameObject:SetActive(false)                   \r\n                    so:BreakAllStab()\r\n                end\r\n            end\r\n        end\r\n    , 0, 0.1):\r\n    SetUpdateChannel(CL.Scheduler.UpdateChannel.FixedUpdate).actionId\r\nend\r\n\r\nreturn Class(nil,nil,table)\n"})}),"\n",(0,l.jsx)(t.h2,{id:"component",children:"Component"}),"\n",(0,l.jsx)(t.p,{children:(0,l.jsx)(t.img,{alt:"Component",src:n(7093).A+"",width:"728",height:"674"})})]})}function p(e={}){const{wrapper:t}={...(0,s.RP)(),...e.components};return t?(0,l.jsx)(t,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},7093:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/script-retractable1-bd3e7c29cc2b533d6818ac662be76352.png"},8453:(e,t,n)=>{n.d(t,{RP:()=>s,xA:()=>a});var r=n(6540);const l=r.createContext({});function s(e){const t=r.useContext(l);return r.useMemo((()=>"function"==typeof e?e(t):{...t,...e}),[t,e])}const c={};function a({components:e,children:t,disableParentContext:n}){let a;return a=n?"function"==typeof e?e({}):e||c:s(e),r.createElement(l.Provider,{value:a},t)}}}]);