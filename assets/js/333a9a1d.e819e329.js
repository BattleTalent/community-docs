"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[672],{8453:(e,n,r)=>{r.d(n,{RP:()=>c,xA:()=>i});var t=r(6540);const l=t.createContext({});function c(e){const n=t.useContext(l);return t.useMemo((()=>"function"==typeof e?e(n):{...n,...e}),[n,e])}const s={};function i({components:e,children:n,disableParentContext:r}){let i;return i=r?"function"==typeof e?e({}):e||s:c(e),t.createElement(l.Provider,{value:i},n)}},8844:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"LuaScript/Reference by category/Time/snippet-scheduler","title":"Scheduler","description":"xLua doesn\'t have an update function by itself, but we can fake it. The following script can be added to LuaBehaviour or InteractTriggerX to call a function on an interval.","source":"@site/docs/LuaScript/4.Reference by category/2.Time/snippet-scheduler.md","sourceDirName":"LuaScript/4.Reference by category/2.Time","slug":"/LuaScript/Reference by category/Time/snippet-scheduler","permalink":"/community-docs/docs/LuaScript/Reference by category/Time/snippet-scheduler","draft":false,"unlisted":false,"editUrl":"https://github.com/BattleTalent/community-docs/docs/LuaScript/4.Reference by category/2.Time/snippet-scheduler.md","tags":[],"version":"current","frontMatter":{"title":"Scheduler"},"sidebar":"docs","previous":{"title":"UE - New Vector3","permalink":"/community-docs/docs/LuaScript/Reference by category/Basic/snippet-ue-vector-3"},"next":{"title":"UE - Time","permalink":"/community-docs/docs/LuaScript/Reference by category/Time/snippet-ue-time"}}');var l=r(4848),c=r(8453);const s={title:"Scheduler"},i=void 0,d={},o=[{value:"Example",id:"example",level:2},{value:"User Variables",id:"user-variables",level:2},{value:"FAQ",id:"faq",level:2},{value:"Can I stop the scheduler after a certain time?",id:"can-i-stop-the-scheduler-after-a-certain-time",level:3},{value:"Can I stop the scheduler from slowing down during slow motion?",id:"can-i-stop-the-scheduler-from-slowing-down-during-slow-motion",level:3},{value:"Tricks",id:"tricks",level:2},{value:"Call a function on the next frame",id:"call-a-function-on-the-next-frame",level:3},{value:"Lerp a value (you can even use this with Curve)",id:"lerp-a-value-you-can-even-use-this-with-curve",level:3},{value:"Stop inside scheduler function",id:"stop-inside-scheduler-function",level:3}];function a(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,c.RP)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(n.p,{children:["xLua doesn't have an update function by itself, but we can fake it. The following script can be added to ",(0,l.jsx)(n.code,{children:"LuaBehaviour"})," or ",(0,l.jsx)(n.code,{children:"InteractTriggerX"})," to call a function on an interval."]}),"\n",(0,l.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"First initialize some variables for the scheduler:"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"self.schedulerId = nil\r\n\r\nself.schedulerInterval = 0.3   --Runs every 0.3 seconds.\r\nself.timeBeforeStarting = 0.2  --Starts after 0.2 seconds.\r\nself.timeBeforeStopping = -1   --Never stops and will run endlessly.\r\nself.ignoreSlowMotion = false  --Will not slow down when slow motion is activated.\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:"Then create functions to schedule:"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'self.callOnSchedulerInterval = function(sche, t, s)\r\n    print("Im updating!") \r\nend\r\n\r\nself.callOnSchedulerStop = function(sche)\r\n    print("Im stopping now")\r\nend\n'})}),"\n",(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsx)(n.li,{children:"Create the scheduler itself somewhere:"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"self.schedulerId = CL.Scheduler.Create({},\r\n    self.callOnSchedulerInterval,\r\n    self.schedulerInterval,\r\n    self.timeBeforeStopping,\r\n    self.timeBeforeStarting\r\n):SetUpdateChannel(CL.Scheduler.UpdateChannel.FixedUpdate)\r\n:IgnoreTimeScale(self.ignoreSlowMotion)\r\n:SetOnStop(self.callOnSchedulerStop).actionId\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"4",children:["\n",(0,l.jsx)(n.li,{children:"Important! Don't forget to remove the scheduler or it will continue to run and will drain performance."}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"CL.Scheduler.RemoveSchedule(self.schedulerId)\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"It is very important"})," though that you also call the ",(0,l.jsx)(n.code,{children:"RemoveSchedule"})," function in the ",(0,l.jsx)(n.code,{children:"OnDestroy"})," function so that it stops running when the weapon is destroyed."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"function table:OnDestroy()\r\n    if self.schedulerId ~= nil then\r\n        CL.Scheduler.RemoveSchedule(self.schedulerId)\r\n    end\r\nend\n"})}),"\n",(0,l.jsx)(n.h2,{id:"user-variables",children:"User Variables"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Component"}),(0,l.jsx)(n.th,{children:"variable"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"doesnt matter"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"self.schedulerId"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"int"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"self.schedulerInterval"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"int"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"self.timeBeforeStopping"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"int"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"self.timeBeforeStarting"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"bool"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"self.ignoreSlowMotion"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"func"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"self.callOnSchedulerInterval"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"func"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"self.callOnSchedulerStop"})})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"faq",children:"FAQ"}),"\n",(0,l.jsx)(n.h3,{id:"can-i-stop-the-scheduler-after-a-certain-time",children:"Can I stop the scheduler after a certain time?"}),"\n",(0,l.jsxs)(n.p,{children:["Change the ",(0,l.jsx)(n.code,{children:"self.timeBeforeStopping"})," to ",(0,l.jsx)(n.code,{children:"10"})," to stop it after 10 seconds."]}),"\n",(0,l.jsx)(n.h3,{id:"can-i-stop-the-scheduler-from-slowing-down-during-slow-motion",children:"Can I stop the scheduler from slowing down during slow motion?"}),"\n",(0,l.jsxs)(n.p,{children:["Change the ",(0,l.jsx)(n.code,{children:"self.ignoreSlowMotion"})," to ",(0,l.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,l.jsx)(n.h2,{id:"tricks",children:"Tricks"}),"\n",(0,l.jsx)(n.h3,{id:"call-a-function-on-the-next-frame",children:"Call a function on the next frame"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:'local callOnSchedulerInterval = function(sche, t, s)\r\n    print("im executing next frame!") \r\nend\r\n\r\nCL.Scheduler.Create({}, callOnSchedulerInterval)\n'})}),"\n",(0,l.jsx)(n.h3,{id:"lerp-a-value-you-can-even-use-this-with-curve",children:"Lerp a value (you can even use this with Curve)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local callOnSchedulerInterval = function(sche, t, s)\r\n\tlocal progress = t/s\r\n    local lerpedVec = UE.Vector3.Lerp(fromVector, toVector, progress)\r\n    print(lerpedVec)\r\nend\r\n\r\nCL.Scheduler.Create({}, callOnSchedulerInterval, 0, 1)\n"})}),"\n",(0,l.jsx)(n.h3,{id:"stop-inside-scheduler-function",children:"Stop inside scheduler function"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-lua",children:"local callOnSchedulerInterval = function(sche, t, s)\r\n    sche:Stop()\r\nend\r\n\r\nCL.Scheduler.Create({}, callOnSchedulerInterval, 0, 1)\n"})})]})}function h(e={}){const{wrapper:n}={...(0,c.RP)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}}}]);